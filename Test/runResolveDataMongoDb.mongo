// 2.ครัวเรือนทั้งหมด -> IsHouseHold (do)
db.NewDataProcess.updateMany(
  {
    SampleType: "u",
    IsHouseHold: 0,
    CountPopulation: { $gt: 0 },
  },
  {
    $set: {
      CountPopulation: 0,
    },
  }
);

db.NewDataProcess.aggregate([
  {
    $match: {
      SampleType: "u",
      IsHouseHold: 0,
      CountPopulation: { $gt: 0 }
    }
  },
  {
    $project: {
      SampleId:1
    }
  },
  {
    $out: "CheckUpdateIsHouseHold"
  }
]);

//16.ระดับความลึกของน้ำท่วม (ในเขตที่อยู่อาศัย) -> AvgWaterHeightCm
//17.ระยะเวลาที่น้ำท่วมขัง (ในเขตที่อยู่อาศัย) -> TimeWaterHeightCm
db.NewDataProcess.updateMany([
  {
    $or: [{ AvgWaterHeightCm: 0 }, { TimeWaterHeightCm: 0 }],
  },
  {
    $set: {
      AvgWaterHeightCm: 0,
      TimeWaterHeightCm: 0,
    }
  }
]);

db.NewDataProcess.aggregate([
  {
    $match: {
      $or: [{ AvgWaterHeightCm: 0 }, { TimeWaterHeightCm: 0 }]
    }
  },
  {
    $project: {
      AvgWaterHeightCm:1,
      TimeWaterHeightCm:1
    }
  },
  {
    $match: {
      AvgWaterHeightCm: 1,
      TimeWaterHeightCm: 0
    }
  },
  {
    $out: "CheckUpdateAvgAndTimeWaterHeightCm1"
  }
]);

db.NewDataProcess.aggregate([
  {
    $match: {
      $or: [{ AvgWaterHeightCm: 0 }, { TimeWaterHeightCm: 0 }]
    }
  },
  {
    $project: {
      AvgWaterHeightCm:1,
      TimeWaterHeightCm:1
    }
  },
  {
    $match: {
      AvgWaterHeightCm: 0,
      TimeWaterHeightCm: 1
    }
  },
  {
    $out: "CheckUpdateAvgAndTimeWaterHeightCm2"
  }
]);

//23.แหล่งน้ำขนาดใหญ่ กลาง และเล็ก (สน.2) -> WaterSources (do) ->
db.NewDataProcess.updateMany([
  {
    SampleType: "c",
    WaterSources: { $lt: 1260 },
  },
  {
    $set: {
      WaterSources: 0,
    }
  }
]);

db.NewDataProcess.aggregate([
  {
    $match: {
      SampleType: "c",
      WaterSources: { $lt: 1260 }
    }
  },
  {
    $project: {
      WaterSources:1
    }
  },
  {
    $match: {
      WaterSources: {
        $gt: 0
      }
    }
  },
  {
    $out: "CheckUpdateWaterSources"
  }
]);

// create result data EA
db.NewDataProcess.aggregate(
  [
    {
      $group: {
        _id: "$EA",
        IsAgriculture: {
          $sum: "$IsAgriculture",
        },
        IsHouseHold: {
          $sum: "$IsHouseHold",
        },
        IsHouseHoldGoodPlumbing: {
          $sum: "$IsHouseHoldGoodPlumbing",
        },
        IsAgricultureHasIrrigationField: {
          $sum: "$IsAgricultureHasIrrigationField",
        },
        IsHouseHoldHasPlumbingDistrict: {
          $sum: "$IsHouseHoldHasPlumbingDistrict",
        },
        IsHouseHoldHasPlumbingCountryside: {
          $sum: "$IsHouseHoldHasPlumbingCountryside",
        },
        IsFactorialWaterQuality: {
          $sum: "$IsFactorialWaterQuality",
        },
        IsCommercialWaterQuality: {
          $sum: "$IsCommercialWaterQuality",
        },
        CountPopulation: {
          $sum: "$CountPopulation",
        },
        CountWorkingAge: {
          $sum: "$CountWorkingAge",
        },
        IsFactorial: {
          $sum: "$IsFactorial",
        },
        IsFactorialWaterTreatment: {
          $sum: "$IsFactorialWaterTreatment",
        },
        IsCommunityWaterManagementHasWaterTreatment: {
          $sum: "$IsCommunityWaterManagementHasWaterTreatment",
        },
        FieldCommunity: {
          $sum: "$FieldCommunity",
        },
        AvgWaterHeightCm: {
          $avg: "$AvgWaterHeightCm",
        },
        TimeWaterHeightCm: {
          $avg: "$TimeWaterHeightCm",
        },
        HasntPlumbing: {
          $avg: "$HasntPlumbing",
        },
        IsGovernment: {
          $sum: "$IsGovernment",
        },
        IsGovernmentUsage: {
          $sum: "$IsGovernmentUsage",
        },
        IsGovernmentWaterQuality: {
          $sum: "$IsGovernmentWaterQuality",
        },
        CommunityNatureDisaster: {
          $sum: "$CommunityNatureDisaster",
        },
        IndustryHasWasteWaterTreatment: {
          $sum: "$IndustryHasWasteWaterTreatment",
        },
        PeopleInFloodedArea: {
          $sum: "$PeopleInFloodedArea",
        },
        CountCommunity: {
          $sum: "$CountCommunity",
        },
        CountCommunityHasDisaster: {
          $sum: "$CountCommunityHasDisaster",
        },
        IsAllHouseHoldCountryside: {
          $sum: "$IsAllHouseHoldCountryside",
        },
        IsAllHouseHoldDistrict: {
          $sum: "$IsAllHouseHoldDistrict",
        },
        IsAllFactorial: {
          $sum: "$IsAllFactorial",
        },
        IsAllCommercial: {
          $sum: "$IsAllCommercial",
        },
      },
    },
    {
      $project: {
        IsAgriculture: 1,
        IsHouseHold: 1,
        IsHouseHoldGoodPlumbing: 1,
        IsAgricultureHasIrrigationField: 1,
        IsHouseHoldHasPlumbingDistrict: 1,
        IsHouseHoldHasPlumbingCountryside: 1,
        IsFactorialWaterQuality: 1,
        IsCommercialWaterQuality: 1,
        CountPopulation: 1,
        CountWorkingAge: 1,
        IsFactorial: 1,
        IsFactorialWaterTreatment: 1,
        IsCommunityWaterManagementHasWaterTreatment: 1,
        FieldCommunity: 1,
        AvgWaterHeightCm: 1,
        TimeWaterHeightCm: 1,
        HasntPlumbing: 1,
        IsGovernment: 1,
        IsGovernmentUsage: 1,
        IsGovernmentWaterQuality: 1,
        CommunityNatureDisaster: 1,
        IndustryHasWasteWaterTreatment: 1,
        PeopleInFloodedArea: 1,
        CountCommunity: 1,
        CountCommunityHasDisaster: 1,
        IsAllHouseHoldCountryside: 1,
        IsAllHouseHoldDistrict: 1,
        IsAllFactorial: 1,
        IsAllCommercial: 1,
        CountGroundWaterUnit: {
          $toInt: 0,
        },
        CountGroundWaterCom: {
          $toInt: 0,
        },
        WaterSourcesUnit: {
          $toInt: 0,
        },
        WaterSourcesCom: {
          $toInt: 0,
        },
      },
    },
    {
      $out: "ResultNewDataEA",
    }
  ],
  {
    allowDiskUse: true,
  }
);

// add field ResultNewDataEA
db.ResultNewDataEA.aggregate(
  [
    {
      $lookup: {
        from: "ea",
        localField: "_id",
        foreignField: "_id",
        as: "dataEAInfo",
      },
    },
    {
      $unwind: {
        path: "$dataEAInfo",
        preserveNullAndEmptyArrays: true,
      },
    },
    {
      $project: {
        REG: {
          $ifNull: ["$dataEAInfo.REG", ""],
        },
        REG_NAME: {
          $ifNull: ["$dataEAInfo.REG_NAME", ""],
        },
        CWT: {
          $ifNull: ["$dataEAInfo.CWT", ""],
        },
        CWT_NAME: {
          $ifNull: ["$dataEAInfo.CWT_NAME", ""],
        },
        AMP: {
          $ifNull: ["$dataEAInfo.AMP", ""],
        },
        AMP_NAME: {
          $ifNull: ["$dataEAInfo.AMP_NAME", ""],
        },
        TAM: {
          $ifNull: ["$dataEAInfo.TAM", ""],
        },
        TAM_NAME: {
          $ifNull: ["$dataEAInfo.TAM_NAME", ""],
        },
        MUN: {
          $ifNull: ["$dataEAInfo.MUN", ""],
        },
        MUN_NAME: {
          $ifNull: ["$dataEAInfo.MUN_NAME", ""],
        },
        TAO: {
          $ifNull: ["$dataEAInfo.TAO", ""],
        },
        TAO_NAME: {
          $ifNull: ["$dataEAInfo.TAO_NAME", ""],
        },
        VIL: {
          $ifNull: ["$dataEAInfo.VIL", ""],
        },
        VIL_NAME: {
          $ifNull: ["$dataEAInfo.VIL_NAME", ""],
        },
        IsAgriculture: 1,
        IsHouseHold: 1,
        IsHouseHoldGoodPlumbing: 1,
        IsAgricultureHasIrrigationField: 1,
        IsHouseHoldHasPlumbingDistrict: 1,
        IsHouseHoldHasPlumbingCountryside: 1,
        IsFactorialWaterQuality: 1,
        IsCommercialWaterQuality: 1,
        CountPopulation: 1,
        CountWorkingAge: 1,
        IsFactorial: 1,
        IsFactorialWaterTreatment: 1,
        IsCommunityWaterManagementHasWaterTreatment: 1,
        FieldCommunity: 1,
        AvgWaterHeightCm: 1,
        TimeWaterHeightCm: 1,
        HasntPlumbing: 1,
        IsGovernment: 1,
        IsGovernmentUsage: 1,
        IsGovernmentWaterQuality: 1,
        CommunityNatureDisaster: 1,
        IndustryHasWasteWaterTreatment: 1,
        PeopleInFloodedArea: 1,
        CountCommunity: 1,
        CountCommunityHasDisaster: 1,
        IsAllHouseHoldCountryside: 1,
        IsAllHouseHoldDistrict: 1,
        IsAllFactorial: 1,
        IsAllCommercial: 1,
        CountGroundWaterUnit: 1,
        CountGroundWaterCom: 1,
        WaterSourcesUnit: 1,
        WaterSourcesCom: 1,
      },
    },
    {
      $out: "ResultNewDataEAClean",
    }
  ],
  {
    allowDiskUse: true,
  }
);

// create result data areacode
db.NewDataProcess.aggregate([
  {
    $group: {
      _id: "$Area_Code",
      CubicMeterGroundWaterForAgriculture: {
        $sum: "$CubicMeterGroundWaterForAgriculture",
      },
      CubicMeterGroundWaterForService: {
        $sum: "$CubicMeterGroundWaterForService",
      },
      CubicMeterGroundWaterForProduct: {
        $sum: "$CubicMeterGroundWaterForProduct",
      },
      CubicMeterGroundWaterForDrink: {
        $sum: "$CubicMeterGroundWaterForDrink",
      },
      CubicMeterPlumbingForAgriculture: {
        $sum: "$CubicMeterPlumbingForAgriculture",
      },
      CubicMeterPlumbingForService: {
        $sum: "$CubicMeterPlumbingForService",
      },
      CubicMeterPlumbingForProduct: {
        $sum: "$CubicMeterPlumbingForProduct",
      },
      CubicMeterPlumbingForDrink: {
        $sum: "$CubicMeterPlumbingForDrink",
      },
      CubicMeterSurfaceForAgriculture: {
        $sum: "$CubicMeterSurfaceForAgriculture",
      },
      CubicMeterSurfaceForService: {
        $sum: "$CubicMeterSurfaceForService",
      },
      CubicMeterSurfaceForProduct: {
        $sum: "$CubicMeterSurfaceForProduct",
      },
      CubicMeterSurfaceForDrink: {
        $sum: "$CubicMeterSurfaceForDrink",
      },
      CubicMeterGroundWaterForUse: {
        $sum: "$CubicMeterGroundWaterForUse",
      },
    },
  },
  {
    $project: {
      CubicMeterGroundWaterForAgriculture: 1,
      CubicMeterGroundWaterForService: 1,
      CubicMeterGroundWaterForProduct: 1,
      CubicMeterGroundWaterForDrink: 1,
      CubicMeterPlumbingForAgriculture: 1,
      CubicMeterPlumbingForService: 1,
      CubicMeterPlumbingForProduct: 1,
      CubicMeterPlumbingForDrink: 1,
      CubicMeterSurfaceForAgriculture: 1,
      CubicMeterSurfaceForService: 1,
      CubicMeterSurfaceForProduct: 1,
      CubicMeterSurfaceForDrink: 1,
      CubicMeterGroundWaterForUse: 1,
      CountGroundWaterUnit: {
        $toInt: 0,
      },
      CountGroundWaterCom: {
        $toInt: 0,
      },
      WaterSourcesUnit: {
        $toInt: 0,
      },
      WaterSourcesCom: {
        $toInt: 0,
      }
    }
  },
  { $out: "ResultNewDataAreaCode" }
]);

// add field ResultNewDataAreaCode
db.ResultNewDataAreaCode.aggregate(
  [
    {
      $lookup: {
        from: "ea",
        localField: "_id",
        foreignField: "Area_Code",
        as: "dataEAInfo",
      },
    },
    {
      $unwind: {
        path: "$dataEAInfo",
        preserveNullAndEmptyArrays: true,
      },
    },
    {
      $project: {
        REG: {
          $ifNull: ["$dataEAInfo.REG", ""],
        },
        REG_NAME: {
          $ifNull: ["$dataEAInfo.REG_NAME", ""],
        },
        CWT: {
          $ifNull: ["$dataEAInfo.CWT", ""],
        },
        CWT_NAME: {
          $ifNull: ["$dataEAInfo.CWT_NAME", ""],
        },
        AMP: {
          $ifNull: ["$dataEAInfo.AMP", ""],
        },
        AMP_NAME: {
          $ifNull: ["$dataEAInfo.AMP_NAME", ""],
        },
        TAM: {
          $ifNull: ["$dataEAInfo.TAM", ""],
        },
        TAM_NAME: {
          $ifNull: ["$dataEAInfo.TAM_NAME", ""],
        },
        CubicMeterGroundWaterForAgriculture: 1,
        CubicMeterGroundWaterForService: 1,
        CubicMeterGroundWaterForProduct: 1,
        CubicMeterGroundWaterForDrink: 1,
        CubicMeterPlumbingForAgriculture: 1,
        CubicMeterPlumbingForService: 1,
        CubicMeterPlumbingForProduct: 1,
        CubicMeterPlumbingForDrink: 1,
        CubicMeterSurfaceForAgriculture: 1,
        CubicMeterSurfaceForService: 1,
        CubicMeterSurfaceForProduct: 1,
        CubicMeterSurfaceForDrink: 1,
        CubicMeterGroundWaterForUse: 1,
        CountGroundWaterUnit: 1,
        CountGroundWaterCom: 1,
        WaterSourcesUnit: 1,
        WaterSourcesCom: 1,
      }
    },
    {
      $out: "ResultNewDataAreaCodeClean",
    }
  ],
  {
    allowDiskUse: true,
  }
);

// add field EaInfo
db.NewDataProcess.aggregate(
  [
    {
      $lookup: {
        from: "ea",
        localField: "EA",
        foreignField: "_id",
        as: "dataEAInfo",
      },
    },
    {
      $unwind: {
        path: "$dataEAInfo",
        preserveNullAndEmptyArrays: true,
      },
    },
    {
      $project: {
        SampleId: 1,
        SampleType: 1,
        EA: 1,
        Area_Code: 1,
        REG: {
          $ifNull: ["$dataEAInfo.REG", ""],
        },
        REG_NAME: {
          $ifNull: ["$dataEAInfo.REG_NAME", ""],
        },
        CWT: {
          $ifNull: ["$dataEAInfo.CWT", ""],
        },
        CWT_NAME: {
          $ifNull: ["$dataEAInfo.CWT_NAME", ""],
        },
        AMP: {
          $ifNull: ["$dataEAInfo.AMP", ""],
        },
        AMP_NAME: {
          $ifNull: ["$dataEAInfo.AMP_NAME", ""],
        },
        TAM: {
          $ifNull: ["$dataEAInfo.TAM", ""],
        },
        TAM_NAME: {
          $ifNull: ["$dataEAInfo.TAM_NAME", ""],
        },
        Status: 1,
        Count: 1,
        CubicMeterPerMonth: 1,
        WaterBill: 1,
        PumpCount: 1,
        PumpAuto: 1,
        TurbidWater: 1,
        SaltWater: 1,
        Smell: 1,
        FilmOfOil: 1,
        FogWater: 1,
        HardWater: 1,
        Agriculture: 1,
        Service: 1,
        Product: 1,
        Drink: 1,
        Plant: 1,
        Farm: 1,
        DoingMWA: 1,
        CubicMeterPerMonthMWA: 1,
        WaterBillMWA: 1,
        TurbidWaterMWA: 1,
        SaltWaterMWA: 1,
        SmellMWA: 1,
        FilmOfOilMWA: 1,
        FogWaterMWA: 1,
        HardWaterMWA: 1,
        AgricultureMWA: 1,
        ServiceMWA: 1,
        ProductMWA: 1,
        DrinkMWA: 1,
        PlantMWA: 1,
        DoingPWA: 1,
        CubicMeterPerMonthPWA: 1,
        WaterBillPWA: 1,
        TurbidWaterPWA: 1,
        SaltWaterPWA: 1,
        SmellPWA: 1,
        FilmOfOilPWA: 1,
        FogWaterPWA: 1,
        HardWaterPWA: 1,
        AgriculturePWA: 1,
        ServicePWA: 1,
        ProductPWA: 1,
        DrinkPWA: 1,
        PlantPWA: 1,
        DoingOther: 1,
        CubicMeterPerMonthOther: 1,
        WaterBillOther: 1,
        TurbidWaterOther: 1,
        SaltWaterOther: 1,
        SmellOther: 1,
        FilmOfOilOther: 1,
        FogWaterOther: 1,
        HardWaterOther: 1,
        AgricultureOther: 1,
        ServiceOther: 1,
        ProductOther: 1,
        DrinkOther: 1,
        PlantOther: 1,
        MeterRentalFee: 1,
        PlumbingPrice: 1,
        PoolCount: 1,
        WaterResourceCount: 1,
        CubicMeterPerMonthPool: 1,
        PumpCountPool: 1,
        PumpAutoPool: 1,
        SaltWaterPool: 1,
        SmellPool: 1,
        FilmOfOilPool: 1,
        FogWaterPool: 1,
        AgriculturePool: 1,
        ServicePool: 1,
        ProductPool: 1,
        DrinkPool: 1,
        PlantPool: 1,
        FarmPool: 1,
        CubicMeterPerMonthIrrigation: 1,
        PumpCountIrrigation: 1,
        PumpAutoIrrigation: 1,
        SaltWaterIrrigation: 1,
        SmellIrrigation: 1,
        FilmOfOilIrrigation: 1,
        FogWaterIrrigation: 1,
        AgricultureIrrigation: 1,
        ServiceIrrigation: 1,
        ProductIrrigation: 1,
        DrinkIrrigation: 1,
        PlantIrrigation: 1,
        FarmIrrigation: 1,
        PumpCountRiver: 1,
        PumpAutoRiver: 1,
        SaltWaterRiver: 1,
        SmellRiver: 1,
        FilmOfOilRiver: 1,
        FogWaterRiver: 1,
        AgricultureRiver: 1,
        ServiceRiver: 1,
        ProductRiver: 1,
        DrinkRiver: 1,
        PlantRiver: 1,
        FarmRiver: 1,
        AgricultureRain: 1,
        ServiceRain: 1,
        ProductRain: 1,
        DrinkRain: 1,
        PlantRain: 1,
        CanComputeCubicMeterGroundWaterForAgriculture: 1,
        CanComputeCubicMeterGroundWaterForService: 1,
        CanComputeCubicMeterGroundWaterForProduct: 1,
        CanComputeCubicMeterGroundWaterForDrink: 1,
        CanComputeCubicMeterPlumbingForAgriculture: 1,
        CanComputeCubicMeterPlumbingForService: 1,
        CanComputeCubicMeterPlumbingForProduct: 1,
        CanComputeCubicMeterPlumbingForDrink: 1,
        CanComputeCubicMeterSurfaceForAgriculture: 1,
        CanComputeCubicMeterSurfaceForService: 1,
        CanComputeCubicMeterSurfaceForProduct: 1,
        CanComputeCubicMeterSurfaceForDrink: 1,
        CanComputeCubicMeterGroundWaterForUse: 1,
        CanComputeCubicMeterForDrink: 1,
        IsAgriculture: 1,
        IsHouseHold: 1,
        IsHouseHoldGoodPlumbing: 1,
        IsAgricultureHasIrrigationField: 1,
        IsHouseHoldHasPlumbingDistrict: 1,
        IsHouseHoldHasPlumbingCountryside: 1,
        IsFactorialWaterQuality: 1,
        IsCommercialWaterQuality: 1,
        CountGroundWater: 1,
        CountPopulation: 1,
        CountWorkingAge: 1,
        IsFactorial: 1,
        IsFactorialWaterTreatment: 1,
        IsCommunityWaterManagementHasWaterTreatment: 1,
        FieldCommunity: 1,
        AvgWaterHeightCm: 1,
        TimeWaterHeightCm: 1,
        HasntPlumbing: 1,
        IsGovernment: 1,
        IsGovernmentUsage: 1,
        IsGovernmentWaterQuality: 1,
        CommunityNatureDisaster: 1,
        WaterSources: 1,
        IndustryHasWasteWaterTreatment: 1,
        PeopleInFloodedArea: 1,
        CubicMeterGroundWaterForAgricultureGroundWater: 1,
        CubicMeterGroundWaterForAgricultureBuying: 1,
        CubicMeterGroundWaterForAgriculture: 1,
        CubicMeterGroundWaterForServiceGroundWater: 1,
        CubicMeterGroundWaterForServiceBuying: 1,
        CubicMeterGroundWaterForService: 1,
        CubicMeterGroundWaterForProductGroundWater: 1,
        CubicMeterGroundWaterForProductBuying: 1,
        CubicMeterGroundWaterForProduct: 1,
        CubicMeterGroundWaterForDrinkGroundWater: 1,
        CubicMeterGroundWaterForDrinkBuying: 1,
        CubicMeterGroundWaterForDrink: 1,
        CubicMeterPlumbingForAgricultureMWA: 1,
        CubicMeterPlumbingForAgriculturePWA: 1,
        CubicMeterPlumbingForAgricultureOther: 1,
        CubicMeterPlumbingForAgriculture: 1,
        CubicMeterPlumbingForServiceMWA: 1,
        CubicMeterPlumbingForServicePWA: 1,
        CubicMeterPlumbingForServiceOther: 1,
        CubicMeterPlumbingForService: 1,
        CubicMeterPlumbingForProductMWA: 1,
        CubicMeterPlumbingForProductPWA: 1,
        CubicMeterPlumbingForProductOther: 1,
        CubicMeterPlumbingForProduct: 1,
        CubicMeterPlumbingForDrinkMWA: 1,
        CubicMeterPlumbingForDrinkPWA: 1,
        CubicMeterPlumbingForDrinkOther: 1,
        CubicMeterPlumbingForDrink: 1,
        CubicMeterSurfaceForAgriculturePool: 1,
        CubicMeterSurfaceForAgricultureRiver: 1,
        CubicMeterSurfaceForAgricultureIrrigation: 1,
        CubicMeterSurfaceForAgricultureRain: 1,
        CubicMeterSurfaceForAgriculture: 1,
        CubicMeterSurfaceForServicePool: 1,
        CubicMeterSurfaceForServiceRiver: 1,
        CubicMeterSurfaceForServiceIrrigation: 1,
        CubicMeterSurfaceForServiceRain: 1,
        CubicMeterSurfaceForService: 1,
        CubicMeterSurfaceForProductPool: 1,
        CubicMeterSurfaceForProductRiver: 1,
        CubicMeterSurfaceForProductIrrigation: 1,
        CubicMeterSurfaceForProductRain: 1,
        CubicMeterSurfaceForProduct: 1,
        CubicMeterSurfaceForDrinkPool: 1,
        CubicMeterSurfaceForDrinkRiver: 1,
        CubicMeterSurfaceForDrinkIrrigation: 1,
        CubicMeterSurfaceForDrinkRain: 1,
        CubicMeterSurfaceForDrink: 1,
        CubicMeterGroundWaterForUse: 1,
        CountCommunity: 1,
        CountCommunityHasDisaster: 1,
        IsAllHouseHoldCountryside: 1,
        IsAllHouseHoldDistrict: 1,
        IsAllFactorial: 1,
        IsAllCommercial: 1,
        CubicMeterForDrink: 1,
        Duplicate: 1,
        AdjustedCubicMeterGroundWaterForAgriculture: 1,
        AdjustedCubicMeterGroundWaterForService: 1,
        AdjustedCubicMeterGroundWaterForProduct: 1,
        AdjustedCubicMeterGroundWaterForDrink: 1,
        AdjustedCubicMeterSurfaceForAgriculture: 1,
        AdjustedCubicMeterSurfaceForService: 1,
        AdjustedCubicMeterSurfaceForProduct: 1,
        AdjustedCubicMeterSurfaceForDrink: 1,
        AdjustedCubicMeterGroundWaterForUse: 1,
        Road: 1,
        IsAdditionalCom: 1,
      },
    },
    {
      $out: "NewDataProcessBKKClean",
    }
  ],
  {
    allowDiskUse: true,
  }
);

db.NewDataProcess.aggregate([
  {
    $match: {
      $or: [
        {
          $and: [{ AvgWaterHeightCm: 0 }, { TimeWaterHeightCm: 1 }],
        },
        {
          $and: [{ AvgWaterHeightCm: 1 }, { TimeWaterHeightCm: 0 }],
        }
      ]
    },
  },
  {
    $count: "countError",
  },
  {
    $out: "checkResolveAvgWaterHeightCmAndTimeWaterHeightCm",
  }
]);

db.IndexInZipFile.aggregate([
  {
    $match: {
      ContainerName: "m63703985800444661280505569",
    },
  },
  {
    $project: {
      _id: "$ContainerName",
    },
  },
  {
    $out: "Testm63703985800444661280505569"
  }
]);

// Manage Data For Machine Learning
db.NewDataProcess.aggregate([
  {
    $match: {
      CanComputeCubicMeterPlumbingForDrink: "True",
    }
  },
  {
    $project: {
        SampleId: 1,
        SampleType: 1,
        EA: 1,
        Area_Code: 1,
        REG: 1,
        REG_NAME: 1,
        CWT: 1,
        CWT_NAME: 1,
        AMP: 1,
        AMP_NAME: 1,
        TAM: 1,
        TAM_NAME: 1,
        Status: 1,
        Count: 1,
        CubicMeterPerMonth: 1,
        WaterBill: 1,
        PumpCount: 1,
        PumpAuto: 1,
        TurbidWater: 1,
        SaltWater: 1,
        Smell: 1,
        FilmOfOil: 1,
        FogWater: 1,
        HardWater: 1,
        Agriculture: 1,
        Service: 1,
        Product: 1,
        Drink: 1,
        Plant: 1,
        Farm: 1,
        DoingMWA: 1,
        CubicMeterPerMonthMWA: 1,
        WaterBillMWA: 1,
        TurbidWaterMWA: 1,
        SaltWaterMWA: 1,
        SmellMWA: 1,
        FilmOfOilMWA: 1,
        FogWaterMWA: 1,
        HardWaterMWA: 1,
        AgricultureMWA: 1,
        ServiceMWA: 1,
        ProductMWA: 1,
        DrinkMWA: 1,
        PlantMWA: 1,
        DoingPWA: 1,
        CubicMeterPerMonthPWA: 1,
        WaterBillPWA: 1,
        TurbidWaterPWA: 1,
        SaltWaterPWA: 1,
        SmellPWA: 1,
        FilmOfOilPWA: 1,
        FogWaterPWA: 1,
        HardWaterPWA: 1,
        AgriculturePWA: 1,
        ServicePWA: 1,
        ProductPWA: 1,
        DrinkPWA: 1,
        PlantPWA: 1,
        DoingOther: 1,
        CubicMeterPerMonthOther: 1,
        WaterBillOther: 1,
        TurbidWaterOther: 1,
        SaltWaterOther: 1,
        SmellOther: 1,
        FilmOfOilOther: 1,
        FogWaterOther: 1,
        HardWaterOther: 1,
        AgricultureOther: 1,
        ServiceOther: 1,
        ProductOther: 1,
        DrinkOther: 1,
        PlantOther: 1,
        MeterRentalFee: 1,
        PlumbingPrice: 1,
        PoolCount: 1,
        WaterResourceCount: 1,
        CubicMeterPerMonthPool: 1,
        PumpCountPool: 1,
        PumpAutoPool: 1,
        SaltWaterPool: 1,
        SmellPool: 1,
        FilmOfOilPool: 1,
        FogWaterPool: 1,
        AgriculturePool: 1,
        ServicePool: 1,
        ProductPool: 1,
        DrinkPool: 1,
        PlantPool: 1,
        FarmPool: 1,
        CubicMeterPerMonthIrrigation: 1,
        PumpCountIrrigation: 1,
        PumpAutoIrrigation: 1,
        SaltWaterIrrigation: 1,
        SmellIrrigation: 1,
        FilmOfOilIrrigation: 1,
        FogWaterIrrigation: 1,
        AgricultureIrrigation: 1,
        ServiceIrrigation: 1,
        ProductIrrigation: 1,
        DrinkIrrigation: 1,
        PlantIrrigation: 1,
        FarmIrrigation: 1,
        PumpCountRiver: 1,
        PumpAutoRiver: 1,
        SaltWaterRiver: 1,
        SmellRiver: 1,
        FilmOfOilRiver: 1,
        FogWaterRiver: 1,
        AgricultureRiver: 1,
        ServiceRiver: 1,
        ProductRiver: 1,
        DrinkRiver: 1,
        PlantRiver: 1,
        FarmRiver: 1,
        AgricultureRain: 1,
        ServiceRain: 1,
        ProductRain: 1,
        DrinkRain: 1,
        PlantRain: 1,
        CanComputeCubicMeterGroundWaterForAgriculture: 1,
        CanComputeCubicMeterGroundWaterForService: 1,
        CanComputeCubicMeterGroundWaterForProduct: 1,
        CanComputeCubicMeterGroundWaterForDrink: 1,
        CanComputeCubicMeterPlumbingForAgriculture: 1,
        CanComputeCubicMeterPlumbingForService: 1,
        CanComputeCubicMeterPlumbingForProduct: 1,
        CanComputeCubicMeterPlumbingForDrink: 1, 
        CanComputeCubicMeterSurfaceForAgriculture: 1,
        CanComputeCubicMeterSurfaceForService: 1,
        CanComputeCubicMeterSurfaceForProduct: 1,
        CanComputeCubicMeterSurfaceForDrink: 1,
        CanComputeCubicMeterGroundWaterForUse: 1,
        CanComputeCubicMeterForDrink: 1,
        IsAgriculture: 1,
        IsHouseHold: 1,
        IsHouseHoldGoodPlumbing: 1,
        IsAgricultureHasIrrigationField: 1,
        IsHouseHoldHasPlumbingDistrict: 1,
        IsHouseHoldHasPlumbingCountryside: 1,
        IsFactorialWaterQuality: 1,
        IsCommercialWaterQuality: 1,
        CountGroundWater: 1,
        CountPopulation: 1,
        CountWorkingAge: 1,
        IsFactorial: 1,
        IsFactorialWaterTreatment: 1,
        IsCommunityWaterManagementHasWaterTreatment: 1,
        FieldCommunity: 1,
        AvgWaterHeightCm: 1,
        TimeWaterHeightCm: 1,
        HasntPlumbing: 1,
        IsGovernment: 1,
        IsGovernmentUsage: 1,
        IsGovernmentWaterQuality: 1,
        CommunityNatureDisaster: 1,
        WaterSources: 1,
        IndustryHasWasteWaterTreatment: 1,
        PeopleInFloodedArea: 1,
        CubicMeterGroundWaterForAgricultureGroundWater: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForAgriculture" : "False"},{"$CanComputeCubicMeterGroundWaterForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForAgricultureBuying: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForAgriculture" : "False"},{"$CanComputeCubicMeterGroundWaterForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForAgriculture: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForAgriculture" : "False"},{"$CanComputeCubicMeterGroundWaterForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForServiceGroundWater: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForService" : "False"},{"$CanComputeCubicMeterGroundWaterForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForServiceBuying: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForService" : "False"},{"$CanComputeCubicMeterGroundWaterForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForService: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForService" : "False"},{"$CanComputeCubicMeterGroundWaterForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForProductGroundWater: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForProduct" : "False"},{"$CanComputeCubicMeterGroundWaterForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForProductBuying: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForProduct" : "False"},{"$CanComputeCubicMeterGroundWaterForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForProduct: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForProduct" : "False"},{"$CanComputeCubicMeterGroundWaterForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForDrinkGroundWater: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForDrink" : "False"},{"$CanComputeCubicMeterGroundWaterForDrink" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForDrinkBuying: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForDrink" : "False"},{"$CanComputeCubicMeterGroundWaterForDrink" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForDrink: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForDrink" : "False"},{"$CanComputeCubicMeterGroundWaterForDrink" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForAgricultureMWA: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForAgriculture" : "False"},{"$CanComputeCubicMeterPlumbingForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForAgriculturePWA: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForAgriculture" : "False"},{"$CanComputeCubicMeterPlumbingForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForAgricultureOther: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForAgriculture" : "False"},{"$CanComputeCubicMeterPlumbingForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForAgriculture: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForAgriculture" : "False"},{"$CanComputeCubicMeterPlumbingForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForServiceMWA: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForService" : "False"},{"$CanComputeCubicMeterPlumbingForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForServicePWA: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForService" : "False"},{"$CanComputeCubicMeterPlumbingForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForServiceOther: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForService" : "False"},{"$CanComputeCubicMeterPlumbingForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForService: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForService" : "False"},{"$CanComputeCubicMeterPlumbingForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForProductMWA: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForProduct" : "False"},{"$CanComputeCubicMeterPlumbingForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForProductPWA: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForProduct" : "False"},{"$CanComputeCubicMeterPlumbingForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForProductOther: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForProduct" : "False"},{"$CanComputeCubicMeterPlumbingForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForProduct: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterPlumbingForProduct" : "False"},{"$CanComputeCubicMeterPlumbingForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterPlumbingForDrinkMWA: 1,
        CubicMeterPlumbingForDrinkPWA: 1,
        CubicMeterPlumbingForDrinkOther: 1,
        CubicMeterPlumbingForDrink: 1,
        CubicMeterSurfaceForAgriculturePool: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForAgriculture" : "False"},{"$CanComputeCubicMeterSurfaceForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForAgricultureRiver: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForAgriculture" : "False"},{"$CanComputeCubicMeterSurfaceForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForAgricultureIrrigation: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForAgriculture" : "False"},{"$CanComputeCubicMeterSurfaceForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForAgricultureRain: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForAgriculture" : "False"},{"$CanComputeCubicMeterSurfaceForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForAgriculture: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForAgriculture" : "False"},{"$CanComputeCubicMeterSurfaceForAgriculture" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForServicePool: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForService" : "False"},{"$CanComputeCubicMeterSurfaceForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForServiceRiver: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForService" : "False"},{"$CanComputeCubicMeterSurfaceForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForServiceIrrigation: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForService" : "False"},{"$CanComputeCubicMeterSurfaceForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForServiceRain: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForService" : "False"},{"$CanComputeCubicMeterSurfaceForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForService: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForService" : "False"},{"$CanComputeCubicMeterSurfaceForService" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForProductPool: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForProduct" : "False"},{"$CanComputeCubicMeterSurfaceForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForProductRiver: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForProduct" : "False"},{"$CanComputeCubicMeterSurfaceForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForProductIrrigation: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForProduct" : "False"},{"$CanComputeCubicMeterSurfaceForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForProductRain: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForProduct" : "False"},{"$CanComputeCubicMeterSurfaceForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForProduct: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForProduct" : "False"},{"$CanComputeCubicMeterSurfaceForProduct" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForDrinkPool:  {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForDrink" : "False"},{"$CanComputeCubicMeterSurfaceForDrink" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForDrinkRiver:  {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForDrink" : "False"},{"$CanComputeCubicMeterSurfaceForDrink" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForDrinkIrrigation:  {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForDrink" : "False"},{"$CanComputeCubicMeterSurfaceForDrink" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForDrinkRain:  {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForDrink" : "False"},{"$CanComputeCubicMeterSurfaceForDrink" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterSurfaceForDrink:  {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterSurfaceForDrink" : "False"},{"$CanComputeCubicMeterSurfaceForDrink" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CubicMeterGroundWaterForUse: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterGroundWaterForUse" : "False"},{"$CanComputeCubicMeterGroundWaterForUse" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        CountCommunity: 1,
        CountCommunityHasDisaster: 1,
        IsAllHouseHoldCountryside: 1,
        IsAllHouseHoldDistrict: 1,
        IsAllFactorial: 1,
        IsAllCommercial: 1,
        CubicMeterForDrink: {
          $cond : {
            if : {
              $or: [{"$CanComputeCubicMeterForDrink" : "False"},{"$CanComputeCubicMeterForDrink" : "NA"}]
            },
            then : null,
            else : 1
          }
        },
        Duplicate: 1,
        AdjustedCubicMeterGroundWaterForAgriculture: 1,
        AdjustedCubicMeterGroundWaterForService: 1,
        AdjustedCubicMeterGroundWaterForProduct: 1,
        AdjustedCubicMeterGroundWaterForDrink: 1,
        AdjustedCubicMeterSurfaceForAgriculture: 1,
        AdjustedCubicMeterSurfaceForService: 1,
        AdjustedCubicMeterSurfaceForProduct: 1,
        AdjustedCubicMeterSurfaceForDrink: 1,
        AdjustedCubicMeterGroundWaterForUse: 1,
        Road: 1,
        IsAdditionalCom: 1
    }
  },
  {
    "$out": "DataCanComputeCubicMeterPlumbingForDrinkForML"
  }
]);

db.NewDataProcess.aggregate([
  {
    $match: {
      CanComputeCubicMeterPlumbingForDrink: "True"
    }
  },
  {
    $project: {
        SampleId: 1,
        SampleType: 1,
        EA: 1,
        Area_Code: 1,
        REG: 1,
        REG_NAME: 1,
        CWT: 1,
        CWT_NAME: 1,
        AMP: 1,
        AMP_NAME: 1,
        TAM: 1,
        TAM_NAME: 1,
        Status: 1,
        Count: 1,
        CubicMeterPerMonth: 1,
        WaterBill: 1,
        PumpCount: 1,
        PumpAuto: 1,
        TurbidWater: 1,
        SaltWater: 1,
        Smell: 1,
        FilmOfOil: 1,
        FogWater: 1,
        HardWater: 1,
        Agriculture: 1,
        Service: 1,
        Product: 1,
        Drink: 1,
        Plant: 1,
        Farm: 1,
        DoingMWA: 1,
        CubicMeterPerMonthMWA: 1,
        WaterBillMWA: 1,
        TurbidWaterMWA: 1,
        SaltWaterMWA: 1,
        SmellMWA: 1,
        FilmOfOilMWA: 1,
        FogWaterMWA: 1,
        HardWaterMWA: 1,
        AgricultureMWA: 1,
        ServiceMWA: 1,
        ProductMWA: 1,
        DrinkMWA: 1,
        PlantMWA: 1,
        DoingPWA: 1,
        CubicMeterPerMonthPWA: 1,
        WaterBillPWA: 1,
        TurbidWaterPWA: 1,
        SaltWaterPWA: 1,
        SmellPWA: 1,
        FilmOfOilPWA: 1,
        FogWaterPWA: 1,
        HardWaterPWA: 1,
        AgriculturePWA: 1,
        ServicePWA: 1,
        ProductPWA: 1,
        DrinkPWA: 1,
        PlantPWA: 1,
        DoingOther: 1,
        CubicMeterPerMonthOther: 1,
        WaterBillOther: 1,
        TurbidWaterOther: 1,
        SaltWaterOther: 1,
        SmellOther: 1,
        FilmOfOilOther: 1,
        FogWaterOther: 1,
        HardWaterOther: 1,
        AgricultureOther: 1,
        ServiceOther: 1,
        ProductOther: 1,
        DrinkOther: 1,
        PlantOther: 1,
        MeterRentalFee: 1,
        PlumbingPrice: 1,
        PoolCount: 1,
        WaterResourceCount: 1,
        CubicMeterPerMonthPool: 1,
        PumpCountPool: 1,
        PumpAutoPool: 1,
        SaltWaterPool: 1,
        SmellPool: 1,
        FilmOfOilPool: 1,
        FogWaterPool: 1,
        AgriculturePool: 1,
        ServicePool: 1,
        ProductPool: 1,
        DrinkPool: 1,
        PlantPool: 1,
        FarmPool: 1,
        CubicMeterPerMonthIrrigation: 1,
        PumpCountIrrigation: 1,
        PumpAutoIrrigation: 1,
        SaltWaterIrrigation: 1,
        SmellIrrigation: 1,
        FilmOfOilIrrigation: 1,
        FogWaterIrrigation: 1,
        AgricultureIrrigation: 1,
        ServiceIrrigation: 1,
        ProductIrrigation: 1,
        DrinkIrrigation: 1,
        PlantIrrigation: 1,
        FarmIrrigation: 1,
        PumpCountRiver: 1,
        PumpAutoRiver: 1,
        SaltWaterRiver: 1,
        SmellRiver: 1,
        FilmOfOilRiver: 1,
        FogWaterRiver: 1,
        AgricultureRiver: 1,
        ServiceRiver: 1,
        ProductRiver: 1,
        DrinkRiver: 1,
        PlantRiver: 1,
        FarmRiver: 1,
        AgricultureRain: 1,
        ServiceRain: 1,
        ProductRain: 1,
        DrinkRain: 1,
        PlantRain: 1,
        CanComputeCubicMeterGroundWaterForAgriculture: 1,
        CanComputeCubicMeterGroundWaterForService: 1,
        CanComputeCubicMeterGroundWaterForProduct: 1,
        CanComputeCubicMeterGroundWaterForDrink: 1,
        CanComputeCubicMeterPlumbingForAgriculture: 1,
        CanComputeCubicMeterPlumbingForService: 1,
        CanComputeCubicMeterPlumbingForProduct: 1,
        CanComputeCubicMeterPlumbingForDrink: 1, 
        CanComputeCubicMeterSurfaceForAgriculture: 1,
        CanComputeCubicMeterSurfaceForService: 1,
        CanComputeCubicMeterSurfaceForProduct: 1,
        CanComputeCubicMeterSurfaceForDrink: 1,
        CanComputeCubicMeterGroundWaterForUse: 1,
        CanComputeCubicMeterForDrink: 1,
        IsAgriculture: 1,
        IsHouseHold: 1,
        IsHouseHoldGoodPlumbing: 1,
        IsAgricultureHasIrrigationField: 1,
        IsHouseHoldHasPlumbingDistrict: 1,
        IsHouseHoldHasPlumbingCountryside: 1,
        IsFactorialWaterQuality: 1,
        IsCommercialWaterQuality: 1,
        CountGroundWater: 1,
        CountPopulation: 1,
        CountWorkingAge: 1,
        IsFactorial: 1,
        IsFactorialWaterTreatment: 1,
        IsCommunityWaterManagementHasWaterTreatment: 1,
        FieldCommunity: 1,
        AvgWaterHeightCm: 1,
        TimeWaterHeightCm: 1,
        HasntPlumbing: 1,
        IsGovernment: 1,
        IsGovernmentUsage: 1,
        IsGovernmentWaterQuality: 1,
        CommunityNatureDisaster: 1,
        WaterSources: 1,
        IndustryHasWasteWaterTreatment: 1,
        PeopleInFloodedArea: 1,
        CubicMeterGroundWaterForAgricultureGroundWater: {
          $cond: {
            if: {
              $or: [ {$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "False"]},{$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForAgricultureGroundWater"
          }
        },
        CubicMeterGroundWaterForAgricultureBuying: {
          $cond: {
            if: {
              $or: [ {$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "False"]},{$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForAgricultureBuying"
          }
        },
        CubicMeterGroundWaterForAgriculture: {
          $cond: {
            if: {
              $or: [ {$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "False"]},{$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForAgriculture"
          }
        },
        CubicMeterGroundWaterForServiceGroundWater: {
          $cond: {
            if: {
              $or: [ { $eq: ["$CanComputeCubicMeterGroundWaterForService","False"] },{$eq: ["$CanComputeCubicMeterGroundWaterForService" ,"NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForServiceGroundWater"
          }
        },
        CubicMeterGroundWaterForServiceBuying: {
          $cond: {
            if: {
              $or: [ { $eq: ["$CanComputeCubicMeterGroundWaterForService","False"] },{$eq: ["$CanComputeCubicMeterGroundWaterForService" ,"NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForServiceBuying"
          }
        },
        CubicMeterGroundWaterForService: {
          $cond: {
            if: {
              $or: [ { $eq: ["$CanComputeCubicMeterGroundWaterForService","False"] },{$eq: ["$CanComputeCubicMeterGroundWaterForService" ,"NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForService"
          }
        },
        CubicMeterGroundWaterForProductGroundWater: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForProductGroundWater"
          }
        },
        CubicMeterGroundWaterForProductBuying: {
          $cond: {
            if: {
              $or:[{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForProductBuying"
          }
        },
        CubicMeterGroundWaterForProduct: {
          $cond: {
            if: {
              $or:[{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForProduct"
          }
        },
        CubicMeterGroundWaterForDrinkGroundWater: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForDrinkGroundWater"
          }
        },
        CubicMeterGroundWaterForDrinkBuying: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForDrinkBuying"
          }
        },
        CubicMeterGroundWaterForDrink: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForDrink"
          }
        },
        CubicMeterPlumbingForAgricultureMWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForAgricultureMWA"
          }
        },
        CubicMeterPlumbingForAgriculturePWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForAgriculturePWA"
          }
        },
        CubicMeterPlumbingForAgricultureOther: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForAgricultureOther"
          }
        },
        CubicMeterPlumbingForAgriculture: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForAgriculture"
          }
        },
        CubicMeterPlumbingForServiceMWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForServiceMWA"
          }
        },
        CubicMeterPlumbingForServicePWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForServicePWA"
          }
        },
        CubicMeterPlumbingForServiceOther: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForServiceOther"
          }
        },
        CubicMeterPlumbingForService: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForService"
          }
        },
        CubicMeterPlumbingForProductMWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForProductMWA"
          }
        },
        CubicMeterPlumbingForProductPWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForProductPWA"
          }
        },
        CubicMeterPlumbingForProductOther: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForProductOther"
          }
        },
        CubicMeterPlumbingForProduct: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForProduct"
          }
        },
        CubicMeterPlumbingForDrinkMWA: 1,
        CubicMeterPlumbingForDrinkPWA: 1,
        CubicMeterPlumbingForDrinkOther: 1,
        CubicMeterPlumbingForDrink: 1,
        CubicMeterSurfaceForAgriculturePool: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForAgriculturePool"
          }
        },
        CubicMeterSurfaceForAgricultureRiver: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForAgricultureRiver"
          }
        },
        CubicMeterSurfaceForAgricultureIrrigation: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForAgricultureIrrigation"
          }
        },
        CubicMeterSurfaceForAgricultureRain: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForAgricultureRain"
          }
        },
        CubicMeterSurfaceForAgriculture: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForAgriculture"
          }
        },
        CubicMeterSurfaceForServicePool: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForServicePool"
          }
        },
        CubicMeterSurfaceForServiceRiver: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForServiceRiver"
          }
        },
        CubicMeterSurfaceForServiceIrrigation: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForServiceIrrigation"
          }
        },
        CubicMeterSurfaceForServiceRain: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForServiceRain"
          }
        },
        CubicMeterSurfaceForService: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForService"
          }
        },
        CubicMeterSurfaceForProductPool: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForProductPool"
          }
        },
        CubicMeterSurfaceForProductRiver: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForProductRiver"
          }
        },
        CubicMeterSurfaceForProductIrrigation: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForProductIrrigation"
          }
        },
        CubicMeterSurfaceForProductRain: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForProductRain"
          }
        },
        CubicMeterSurfaceForProduct: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForProduct"
          }
        },
        CubicMeterSurfaceForDrinkPool:  {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForDrinkPool"
          }
        },
        CubicMeterSurfaceForDrinkRiver:  {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForDrinkRiver"
          }
        },
        CubicMeterSurfaceForDrinkIrrigation:  {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForDrinkIrrigation"
          }
        },
        CubicMeterSurfaceForDrinkRain:  {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForDrinkRain"
          }
        },
        CubicMeterSurfaceForDrink:  {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForDrink"
          }
        },
        CubicMeterGroundWaterForUse: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterGroundWaterForUse" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForUse" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForUse"
          }
        },
        CountCommunity: 1,
        CountCommunityHasDisaster: 1,
        IsAllHouseHoldCountryside: 1,
        IsAllHouseHoldDistrict: 1,
        IsAllFactorial: 1,
        IsAllCommercial: 1,
        CubicMeterForDrink: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterForDrink"
          }
        },
        Duplicate: 1,
        AdjustedCubicMeterGroundWaterForAgriculture: 1,
        AdjustedCubicMeterGroundWaterForService: 1,
        AdjustedCubicMeterGroundWaterForProduct: 1,
        AdjustedCubicMeterGroundWaterForDrink: 1,
        AdjustedCubicMeterSurfaceForAgriculture: 1,
        AdjustedCubicMeterSurfaceForService: 1,
        AdjustedCubicMeterSurfaceForProduct: 1,
        AdjustedCubicMeterSurfaceForDrink: 1,
        AdjustedCubicMeterGroundWaterForUse: 1,
        Road: 1,
        IsAdditionalCom: 1
    }
  },
  {
    $out: "DataCanComputeCubicMeterPlumbingForDrinkForML"
  }
]);

// create DataCanComputeCubicMeterPlumbingForDrinkForML
db.NewDataProcess.aggregate([
  {
    $match: {
      CanComputeCubicMeterPlumbingForDrink: "True"
    }
  },
  {
    $project: {
        SampleId: 1,
        SampleType: 1,
        EA: 1,
        Area_Code: 1,
        REG: 1,
        REG_NAME: 1,
        CWT: 1,
        CWT_NAME: 1,
        AMP: 1,
        AMP_NAME: 1,
        TAM: 1,
        TAM_NAME: 1,
        Status: 1,
        Count: 1,
        CubicMeterPerMonth: 1,
        WaterBill: 1,
        PumpCount: 1,
        PumpAuto: 1,
        TurbidWater: 1,
        SaltWater: 1,
        Smell: 1,
        FilmOfOil: 1,
        FogWater: 1,
        HardWater: 1,
        Agriculture: 1,
        Service: 1,
        Product: 1,
        Drink: 1,
        Plant: 1,
        Farm: 1,
        DoingMWA: 1,
        CubicMeterPerMonthMWA: 1,
        WaterBillMWA: 1,
        TurbidWaterMWA: 1,
        SaltWaterMWA: 1,
        SmellMWA: 1,
        FilmOfOilMWA: 1,
        FogWaterMWA: 1,
        HardWaterMWA: 1,
        AgricultureMWA: 1,
        ServiceMWA: 1,
        ProductMWA: 1,
        DrinkMWA: 1,
        PlantMWA: 1,
        DoingPWA: 1,
        CubicMeterPerMonthPWA: 1,
        WaterBillPWA: 1,
        TurbidWaterPWA: 1,
        SaltWaterPWA: 1,
        SmellPWA: 1,
        FilmOfOilPWA: 1,
        FogWaterPWA: 1,
        HardWaterPWA: 1,
        AgriculturePWA: 1,
        ServicePWA: 1,
        ProductPWA: 1,
        DrinkPWA: 1,
        PlantPWA: 1,
        DoingOther: 1,
        CubicMeterPerMonthOther: 1,
        WaterBillOther: 1,
        TurbidWaterOther: 1,
        SaltWaterOther: 1,
        SmellOther: 1,
        FilmOfOilOther: 1,
        FogWaterOther: 1,
        HardWaterOther: 1,
        AgricultureOther: 1,
        ServiceOther: 1,
        ProductOther: 1,
        DrinkOther: 1,
        PlantOther: 1,
        MeterRentalFee: 1,
        PlumbingPrice: 1,
        PoolCount: 1,
        WaterResourceCount: 1,
        CubicMeterPerMonthPool: 1,
        PumpCountPool: 1,
        PumpAutoPool: 1,
        SaltWaterPool: 1,
        SmellPool: 1,
        FilmOfOilPool: 1,
        FogWaterPool: 1,
        AgriculturePool: 1,
        ServicePool: 1,
        ProductPool: 1,
        DrinkPool: 1,
        PlantPool: 1,
        FarmPool: 1,
        CubicMeterPerMonthIrrigation: 1,
        PumpCountIrrigation: 1,
        PumpAutoIrrigation: 1,
        SaltWaterIrrigation: 1,
        SmellIrrigation: 1,
        FilmOfOilIrrigation: 1,
        FogWaterIrrigation: 1,
        AgricultureIrrigation: 1,
        ServiceIrrigation: 1,
        ProductIrrigation: 1,
        DrinkIrrigation: 1,
        PlantIrrigation: 1,
        FarmIrrigation: 1,
        PumpCountRiver: 1,
        PumpAutoRiver: 1,
        SaltWaterRiver: 1,
        SmellRiver: 1,
        FilmOfOilRiver: 1,
        FogWaterRiver: 1,
        AgricultureRiver: 1,
        ServiceRiver: 1,
        ProductRiver: 1,
        DrinkRiver: 1,
        PlantRiver: 1,
        FarmRiver: 1,
        AgricultureRain: 1,
        ServiceRain: 1,
        ProductRain: 1,
        DrinkRain: 1,
        PlantRain: 1,
        CanComputeCubicMeterGroundWaterForAgriculture: 1,
        CanComputeCubicMeterGroundWaterForService: 1,
        CanComputeCubicMeterGroundWaterForProduct: 1,
        CanComputeCubicMeterGroundWaterForDrink: 1,
        CanComputeCubicMeterPlumbingForAgriculture: 1,
        CanComputeCubicMeterPlumbingForService: 1,
        CanComputeCubicMeterPlumbingForProduct: 1,
        CanComputeCubicMeterPlumbingForDrink: 1, 
        CanComputeCubicMeterSurfaceForAgriculture: 1,
        CanComputeCubicMeterSurfaceForService: 1,
        CanComputeCubicMeterSurfaceForProduct: 1,
        CanComputeCubicMeterSurfaceForDrink: 1,
        CanComputeCubicMeterGroundWaterForUse: 1,
        CanComputeCubicMeterForDrink: 1,
        IsAgriculture: 1,
        IsHouseHold: 1,
        IsHouseHoldGoodPlumbing: 1,
        IsAgricultureHasIrrigationField: 1,
        IsHouseHoldHasPlumbingDistrict: 1,
        IsHouseHoldHasPlumbingCountryside: 1,
        IsFactorialWaterQuality: 1,
        IsCommercialWaterQuality: 1,
        CountGroundWater: 1,
        CountPopulation: 1,
        CountWorkingAge: 1,
        IsFactorial: 1,
        IsFactorialWaterTreatment: 1,
        IsCommunityWaterManagementHasWaterTreatment: 1,
        FieldCommunity: 1,
        AvgWaterHeightCm: 1,
        TimeWaterHeightCm: 1,
        HasntPlumbing: 1,
        IsGovernment: 1,
        IsGovernmentUsage: 1,
        IsGovernmentWaterQuality: 1,
        CommunityNatureDisaster: 1,
        WaterSources: 1,
        IndustryHasWasteWaterTreatment: 1,
        PeopleInFloodedArea: 1,
        CubicMeterGroundWaterForAgricultureGroundWater: 1,
        CubicMeterGroundWaterForAgricultureBuying: 1,
        CubicMeterGroundWaterForAgriculture: 1,
        CubicMeterGroundWaterForServiceGroundWater: 1,
        CubicMeterGroundWaterForServiceBuying: 1,
        CubicMeterGroundWaterForService: 1,
        CubicMeterGroundWaterForProductGroundWater: 1,
        CubicMeterGroundWaterForProductBuying: 1,
        CubicMeterGroundWaterForProduct: 1,
        CubicMeterGroundWaterForDrinkGroundWater: 1,
        CubicMeterGroundWaterForDrinkBuying: 1,
        CubicMeterGroundWaterForDrink: 1,
        CubicMeterPlumbingForAgricultureMWA: 1,
        CubicMeterPlumbingForAgriculturePWA: 1,
        CubicMeterPlumbingForAgricultureOther: 1,
        CubicMeterPlumbingForAgriculture: 1,
        CubicMeterPlumbingForServiceMWA: 1,
        CubicMeterPlumbingForServicePWA: 1,
        CubicMeterPlumbingForServiceOther: 1,
        CubicMeterPlumbingForService: 1,
        CubicMeterPlumbingForProductMWA: 1,
        CubicMeterPlumbingForProductPWA: 1,
        CubicMeterPlumbingForProductOther: 1,
        CubicMeterPlumbingForProduct: 1,
        CubicMeterPlumbingForDrinkMWA: 1,
        CubicMeterPlumbingForDrinkPWA: 1,
        CubicMeterPlumbingForDrinkOther: 1,
        CubicMeterPlumbingForDrink: 1,
        CubicMeterSurfaceForAgriculturePool: 1,
        CubicMeterSurfaceForAgricultureRiver: 1,
        CubicMeterSurfaceForAgricultureIrrigation: 1,
        CubicMeterSurfaceForAgricultureRain: 1,
        CubicMeterSurfaceForAgriculture: 1,
        CubicMeterSurfaceForServicePool: 1,
        CubicMeterSurfaceForServiceRiver: 1,
        CubicMeterSurfaceForServiceIrrigation: 1,
        CubicMeterSurfaceForServiceRain: 1,
        CubicMeterSurfaceForService: 1,
        CubicMeterSurfaceForProductPool: 1,
        CubicMeterSurfaceForProductRiver: 1,
        CubicMeterSurfaceForProductIrrigation: 1,
        CubicMeterSurfaceForProductRain: 1,
        CubicMeterSurfaceForProduct: 1,
        CubicMeterSurfaceForDrinkPool:  1,
        CubicMeterSurfaceForDrinkRiver:  1,
        CubicMeterSurfaceForDrinkIrrigation:  1,
        CubicMeterSurfaceForDrinkRain:  1,
        CubicMeterSurfaceForDrink:  1,
        CubicMeterGroundWaterForUse: 1,
        CountCommunity: 1,
        CountCommunityHasDisaster: 1,
        IsAllHouseHoldCountryside: 1,
        IsAllHouseHoldDistrict: 1,
        IsAllFactorial: 1,
        IsAllCommercial: 1,
        CubicMeterForDrink: 1,
        Duplicate: 1,
        AdjustedCubicMeterGroundWaterForAgriculture: 1,
        AdjustedCubicMeterGroundWaterForService: 1,
        AdjustedCubicMeterGroundWaterForProduct: 1,
        AdjustedCubicMeterGroundWaterForDrink: 1,
        AdjustedCubicMeterSurfaceForAgriculture: 1,
        AdjustedCubicMeterSurfaceForService: 1,
        AdjustedCubicMeterSurfaceForProduct: 1,
        AdjustedCubicMeterSurfaceForDrink: 1,
        AdjustedCubicMeterGroundWaterForUse: 1,
        Road: 1,
        IsAdditionalCom: 1
    }
  },
  {
    $out: "DataCanComputeCubicMeterPlumbingForDrinkForML"
  }
]);

// create DataCanComputeCubicMeterSurfaceForProductForML
db.NewDataProcess.aggregate([
  {
    $match: {
      CanComputeCubicMeterSurfaceForProduct: "True"
    }
  },
  {
    $project: {
        SampleId: 1,
        SampleType: 1,
        EA: 1,
        Area_Code: 1,
        REG: 1,
        REG_NAME: 1,
        CWT: 1,
        CWT_NAME: 1,
        AMP: 1,
        AMP_NAME: 1,
        TAM: 1,
        TAM_NAME: 1,
        Status: 1,
        Count: 1,
        CubicMeterPerMonth: 1,
        WaterBill: 1,
        PumpCount: 1,
        PumpAuto: 1,
        TurbidWater: 1,
        SaltWater: 1,
        Smell: 1,
        FilmOfOil: 1,
        FogWater: 1,
        HardWater: 1,
        Agriculture: 1,
        Service: 1,
        Product: 1,
        Drink: 1,
        Plant: 1,
        Farm: 1,
        DoingMWA: 1,
        CubicMeterPerMonthMWA: 1,
        WaterBillMWA: 1,
        TurbidWaterMWA: 1,
        SaltWaterMWA: 1,
        SmellMWA: 1,
        FilmOfOilMWA: 1,
        FogWaterMWA: 1,
        HardWaterMWA: 1,
        AgricultureMWA: 1,
        ServiceMWA: 1,
        ProductMWA: 1,
        DrinkMWA: 1,
        PlantMWA: 1,
        DoingPWA: 1,
        CubicMeterPerMonthPWA: 1,
        WaterBillPWA: 1,
        TurbidWaterPWA: 1,
        SaltWaterPWA: 1,
        SmellPWA: 1,
        FilmOfOilPWA: 1,
        FogWaterPWA: 1,
        HardWaterPWA: 1,
        AgriculturePWA: 1,
        ServicePWA: 1,
        ProductPWA: 1,
        DrinkPWA: 1,
        PlantPWA: 1,
        DoingOther: 1,
        CubicMeterPerMonthOther: 1,
        WaterBillOther: 1,
        TurbidWaterOther: 1,
        SaltWaterOther: 1,
        SmellOther: 1,
        FilmOfOilOther: 1,
        FogWaterOther: 1,
        HardWaterOther: 1,
        AgricultureOther: 1,
        ServiceOther: 1,
        ProductOther: 1,
        DrinkOther: 1,
        PlantOther: 1,
        MeterRentalFee: 1,
        PlumbingPrice: 1,
        PoolCount: 1,
        WaterResourceCount: 1,
        CubicMeterPerMonthPool: 1,
        PumpCountPool: 1,
        PumpAutoPool: 1,
        SaltWaterPool: 1,
        SmellPool: 1,
        FilmOfOilPool: 1,
        FogWaterPool: 1,
        AgriculturePool: 1,
        ServicePool: 1,
        ProductPool: 1,
        DrinkPool: 1,
        PlantPool: 1,
        FarmPool: 1,
        CubicMeterPerMonthIrrigation: 1,
        PumpCountIrrigation: 1,
        PumpAutoIrrigation: 1,
        SaltWaterIrrigation: 1,
        SmellIrrigation: 1,
        FilmOfOilIrrigation: 1,
        FogWaterIrrigation: 1,
        AgricultureIrrigation: 1,
        ServiceIrrigation: 1,
        ProductIrrigation: 1,
        DrinkIrrigation: 1,
        PlantIrrigation: 1,
        FarmIrrigation: 1,
        PumpCountRiver: 1,
        PumpAutoRiver: 1,
        SaltWaterRiver: 1,
        SmellRiver: 1,
        FilmOfOilRiver: 1,
        FogWaterRiver: 1,
        AgricultureRiver: 1,
        ServiceRiver: 1,
        ProductRiver: 1,
        DrinkRiver: 1,
        PlantRiver: 1,
        FarmRiver: 1,
        AgricultureRain: 1,
        ServiceRain: 1,
        ProductRain: 1,
        DrinkRain: 1,
        PlantRain: 1,
        CanComputeCubicMeterGroundWaterForAgriculture: 1,
        CanComputeCubicMeterGroundWaterForService: 1,
        CanComputeCubicMeterGroundWaterForProduct: 1,
        CanComputeCubicMeterGroundWaterForDrink: 1,
        CanComputeCubicMeterPlumbingForAgriculture: 1,
        CanComputeCubicMeterPlumbingForService: 1,
        CanComputeCubicMeterPlumbingForProduct: 1,
        CanComputeCubicMeterPlumbingForDrink: 1, 
        CanComputeCubicMeterSurfaceForAgriculture: 1,
        CanComputeCubicMeterSurfaceForService: 1,
        CanComputeCubicMeterSurfaceForProduct: 1,
        CanComputeCubicMeterSurfaceForDrink: 1,
        CanComputeCubicMeterGroundWaterForUse: 1,
        CanComputeCubicMeterForDrink: 1,
        IsAgriculture: 1,
        IsHouseHold: 1,
        IsHouseHoldGoodPlumbing: 1,
        IsAgricultureHasIrrigationField: 1,
        IsHouseHoldHasPlumbingDistrict: 1,
        IsHouseHoldHasPlumbingCountryside: 1,
        IsFactorialWaterQuality: 1,
        IsCommercialWaterQuality: 1,
        CountGroundWater: 1,
        CountPopulation: 1,
        CountWorkingAge: 1,
        IsFactorial: 1,
        IsFactorialWaterTreatment: 1,
        IsCommunityWaterManagementHasWaterTreatment: 1,
        FieldCommunity: 1,
        AvgWaterHeightCm: 1,
        TimeWaterHeightCm: 1,
        HasntPlumbing: 1,
        IsGovernment: 1,
        IsGovernmentUsage: 1,
        IsGovernmentWaterQuality: 1,
        CommunityNatureDisaster: 1,
        WaterSources: 1,
        IndustryHasWasteWaterTreatment: 1,
        PeopleInFloodedArea: 1,
        CubicMeterGroundWaterForAgricultureGroundWater: 1,
        CubicMeterGroundWaterForAgricultureBuying: 1,
        CubicMeterGroundWaterForAgriculture: 1,
        CubicMeterGroundWaterForServiceGroundWater: 1,
        CubicMeterGroundWaterForServiceBuying: 1,
        CubicMeterGroundWaterForService: 1,
        CubicMeterGroundWaterForProductGroundWater: 1,
        CubicMeterGroundWaterForProductBuying: 1,
        CubicMeterGroundWaterForProduct: 1,
        CubicMeterGroundWaterForDrinkGroundWater: 1,
        CubicMeterGroundWaterForDrinkBuying: 1,
        CubicMeterGroundWaterForDrink: 1,
        CubicMeterPlumbingForAgricultureMWA: 1,
        CubicMeterPlumbingForAgriculturePWA: 1,
        CubicMeterPlumbingForAgricultureOther: 1,
        CubicMeterPlumbingForAgriculture: 1,
        CubicMeterPlumbingForServiceMWA: 1,
        CubicMeterPlumbingForServicePWA: 1,
        CubicMeterPlumbingForServiceOther: 1,
        CubicMeterPlumbingForService: 1,
        CubicMeterPlumbingForProductMWA: 1,
        CubicMeterPlumbingForProductPWA: 1,
        CubicMeterPlumbingForProductOther: 1,
        CubicMeterPlumbingForProduct: 1,
        CubicMeterPlumbingForDrinkMWA: 1,
        CubicMeterPlumbingForDrinkPWA: 1,
        CubicMeterPlumbingForDrinkOther: 1,
        CubicMeterPlumbingForDrink: 1,
        CubicMeterSurfaceForAgriculturePool: 1,
        CubicMeterSurfaceForAgricultureRiver: 1,
        CubicMeterSurfaceForAgricultureIrrigation: 1,
        CubicMeterSurfaceForAgricultureRain: 1,
        CubicMeterSurfaceForAgriculture: 1,
        CubicMeterSurfaceForServicePool: 1,
        CubicMeterSurfaceForServiceRiver: 1,
        CubicMeterSurfaceForServiceIrrigation: 1,
        CubicMeterSurfaceForServiceRain: 1,
        CubicMeterSurfaceForService: 1,
        CubicMeterSurfaceForProductPool: 1,
        CubicMeterSurfaceForProductRiver: 1,
        CubicMeterSurfaceForProductIrrigation: 1,
        CubicMeterSurfaceForProductRain: 1,
        CubicMeterSurfaceForProduct: 1,
        CubicMeterSurfaceForDrinkPool:  1,
        CubicMeterSurfaceForDrinkRiver:  1,
        CubicMeterSurfaceForDrinkIrrigation:  1,
        CubicMeterSurfaceForDrinkRain:  1,
        CubicMeterSurfaceForDrink:  1,
        CubicMeterGroundWaterForUse: 1,
        CountCommunity: 1,
        CountCommunityHasDisaster: 1,
        IsAllHouseHoldCountryside: 1,
        IsAllHouseHoldDistrict: 1,
        IsAllFactorial: 1,
        IsAllCommercial: 1,
        CubicMeterForDrink: 1,
        Duplicate: 1,
        AdjustedCubicMeterGroundWaterForAgriculture: 1,
        AdjustedCubicMeterGroundWaterForService: 1,
        AdjustedCubicMeterGroundWaterForProduct: 1,
        AdjustedCubicMeterGroundWaterForDrink: 1,
        AdjustedCubicMeterSurfaceForAgriculture: 1,
        AdjustedCubicMeterSurfaceForService: 1,
        AdjustedCubicMeterSurfaceForProduct: 1,
        AdjustedCubicMeterSurfaceForDrink: 1,
        AdjustedCubicMeterGroundWaterForUse: 1,
        Road: 1,
        IsAdditionalCom: 1
    }
  },
  {
    $out: "DataCanComputeCubicMeterSurfaceForProductForML"
  }
]);

// create test data for manage ML
db.DataCanComputeCubicMeterPlumbingForDrinkForML.aggregate([
  {
    $limit : 20
  },
  {
    $out : "TestData1"
  }
]);

// base manage ML
db.TestData1.updateMany(
  {},
  [
    { 
      $set: {
       CubicMeterGroundWaterForAgricultureGroundWater: {
          $cond: {
            if: {
              $or: [ {$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "False"]},{$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForAgricultureGroundWater"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterGroundWaterForAgricultureBuying: {
          $cond: {
            if: {
              $or: [ {$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "False"]},{$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForAgricultureBuying"
          }
        }
      }
    },
    {
      $set: {
         CubicMeterGroundWaterForAgriculture: {
          $cond: {
            if: {
              $or: [ {$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "False"]},{$eq: ["$CanComputeCubicMeterGroundWaterForAgriculture" , "NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForAgriculture"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterGroundWaterForServiceGroundWater: {
          $cond: {
            if: {
              $or: [ { $eq: ["$CanComputeCubicMeterGroundWaterForService","False"] },{$eq: ["$CanComputeCubicMeterGroundWaterForService" ,"NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForServiceGroundWater"
          }
        }
      }
    },
    {
      $set: {
       CubicMeterGroundWaterForServiceBuying: {
          $cond: {
            if: {
              $or: [ { $eq: ["$CanComputeCubicMeterGroundWaterForService","False"] },{$eq: ["$CanComputeCubicMeterGroundWaterForService" ,"NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForServiceBuying"
          }
        }
      }
    },
    {
      $set: {
       CubicMeterGroundWaterForService: {
          $cond: {
            if: {
              $or: [ { $eq: ["$CanComputeCubicMeterGroundWaterForService","False"] },{$eq: ["$CanComputeCubicMeterGroundWaterForService" ,"NA"]}]
            },
            then: null,
            else: "$CubicMeterGroundWaterForService"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterGroundWaterForProductGroundWater: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForProductGroundWater"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterGroundWaterForProductBuying: {
          $cond: {
            if: {
              $or:[{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForProductBuying"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterGroundWaterForProduct: {
          $cond: {
            if: {
              $or:[{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForProduct"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterGroundWaterForDrinkGroundWater: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForDrinkGroundWater"
          }
        }  
      }
    },
    {
      $set: {
        CubicMeterGroundWaterForDrinkBuying: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForDrinkBuying"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterGroundWaterForDrink: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForDrink"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterPlumbingForAgricultureMWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForAgricultureMWA"
          }
        }
      }
    },
    {
      $set: {
         CubicMeterPlumbingForAgriculturePWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForAgriculturePWA"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterPlumbingForAgricultureOther: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForAgricultureOther"
          }
        }
      }
    },
    {
      $set: {
         CubicMeterPlumbingForAgriculture: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForAgriculture"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterPlumbingForServiceMWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForServiceMWA"
          }
        }
      }
    },
    {
      $set: {
         CubicMeterPlumbingForServicePWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForServicePWA"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterPlumbingForServiceOther: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForServiceOther"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterPlumbingForService: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForService"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterPlumbingForProductMWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForProductMWA"
          }
        } 
      }
    },
    {
      $set: {
        CubicMeterPlumbingForProductPWA: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForProductPWA"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterPlumbingForProductOther: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForProductOther"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterPlumbingForProduct: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterPlumbingForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterPlumbingForProduct"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForAgriculturePool: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForAgriculturePool"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForAgricultureRiver: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForAgricultureRiver"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForAgricultureIrrigation: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForAgricultureIrrigation"
          }
        } 
      }
    },
    {
      $set: {
         CubicMeterSurfaceForAgricultureRain: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForAgricultureRain"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForAgriculture: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForAgriculture" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForAgriculture"
          }
        }
      }
    },
    {
      $set: {
         CubicMeterSurfaceForServicePool: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForServicePool"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForServiceRiver: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForServiceRiver"
          }
        }
      }
    },
    {
      $set: {
         CubicMeterSurfaceForServiceIrrigation: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForServiceIrrigation"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForServiceRain: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForServiceRain"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForService: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForService" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForService"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForProductPool: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForProductPool"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForProductRiver: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForProductRiver"
          }
        }
      }
    },
    {
      $set: {
         CubicMeterSurfaceForProductIrrigation: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForProductIrrigation"
          }
        }
      }
    },
    {
      $set: {
         CubicMeterSurfaceForProductRain: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForProductRain"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForProduct: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForProduct" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForProduct"
          }
        }
      }
    },
    {
      $set: {
         CubicMeterSurfaceForDrinkPool:  {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForDrinkPool"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForDrinkRiver:  {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForDrinkRiver"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterSurfaceForDrinkIrrigation:  {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForDrinkIrrigation"
          }
        }
      }
    },
    {
      $set: {
         CubicMeterSurfaceForDrinkRain:  {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForDrinkRain"
          }
        }
      }
    },
    {
      $set: {
         CubicMeterSurfaceForDrink:  {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterSurfaceForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterSurfaceForDrink"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterGroundWaterForUse: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterGroundWaterForUse" , "False"] },{ $eq: ["$CanComputeCubicMeterGroundWaterForUse" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterGroundWaterForUse"
          }
        }
      }
    },
    {
      $set: {
        CubicMeterForDrink: {
          $cond: {
            if: {
              $or: [{ $eq: ["$CanComputeCubicMeterForDrink" , "False"] },{ $eq: ["$CanComputeCubicMeterForDrink" , "NA"] }]
            },
            then: null,
            else: "$CubicMeterForDrink"
          }
        }
      }
    }
  ]
);

// Test merge
db.NewDataProcess.aggregate([
  {
    $limit: 50
  },
  {
    $project: {
      SampleId: 1,
      EA: 1,
      REG:1,
      CWT:1,
      AMP:1,
      TAM:1
    }
  },
  {
    $out: "TestMerge1"
  }
]);

db.NewDataProcess.aggregate([
  {
    $match: {
      REG: "2"
    }
  },
  {
    $limit: 50
  },
  {
    $project: {
      SampleId: 1,
      EA: 1,
      REG:1,
      CWT:1,
      AMP:1,
      TAM:1
    }
  },
  {
    $out: "TestMerge2"
  }
]);

db.TestMerge2.aggregate([
  {
    $merge: "TestMerge1"
  }
]);

db.TestMerge1.deleteMany(
  {
    REG: "2"
  }
);

// merge newDataProcess with dataMissing
db.dataMissing.aggregate([
  {
    $merge: "NewDataProcess"
  }
]);

db.NewDataProcess.deleteMany(
{
  IsOldData: true
}
);

db.dataMissing.aggregate([
  {
    $match: {
      IsOldData: true
    }
  },
  {
    $project: {
      SampleId:1
    }
  },
  {
    $out: "IsOldDataTrue"
  }
])